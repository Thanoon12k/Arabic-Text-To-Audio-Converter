<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>تحويل PDF إلى صور</title>
	<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-[#1b4965] via-[#62b6cb] to-[#e9c46a] text-white">
	<div class="max-w-4xl mx-auto p-6">
		<div class="flex items-center justify-between">
			<h1 class="text-3xl font-extrabold">تحويل PDF إلى صور</h1>
			<a href="/tools" class="rounded-lg bg-white/90 text-[#1b4965] px-4 py-2 font-semibold">العودة للأدوات</a>
		</div>

		<div class="mt-6 bg-white/10 border border-white/20 rounded-2xl p-6">
			<form id="form" class="space-y-4" onsubmit="return false;">
				<div>
					<label class="block mb-1">رفع ملف PDF</label>
					<input id="pdf" type="file" accept="application/pdf" class="block w-full text-black rounded" />
				</div>
				<div>
					<label class="block mb-1">الصفحات المراد تحويلها (مثال: 1-3,5) — اتركه فارغاً لتحويل الكل</label>
					<input id="pages" type="text" class="w-full rounded px-3 py-2 text-black" />
				</div>
				<div>
					<label class="block mb-1">جودة الصورة</label>
					<select id="quality" class="w-full rounded px-3 py-2 text-black">
						<option value="low">منخفضة</option>
						<option value="medium" selected>متوسطة</option>
						<option value="high">عالية</option>
					</select>
				</div>
				<button id="submit" class="rounded-xl bg-[#e9c46a] text-[#7a3b2e] font-bold px-6 py-3">تحويل إلى صور</button>
			</form>

			<div id="result" class="mt-4 hidden">
				<a id="zip" class="rounded-xl bg-white text-[#1b4965] font-semibold px-4 py-2" href="#">تنزيل الصور (ZIP)</a>
			</div>
			<div id="alert" class="mt-4 hidden rounded bg-red-500/20 border border-red-400/40 p-3"></div>
		</div>
	</div>

	<script>
		const pdf = document.getElementById('pdf');
		const pages = document.getElementById('pages');
		const quality = document.getElementById('quality');
		const zip = document.getElementById('zip');
		const result = document.getElementById('result');
		const alertBox = document.getElementById('alert');
		function showError(m){ alertBox.textContent=m; alertBox.classList.remove('hidden'); }
		function hideError(){ alertBox.classList.add('hidden'); alertBox.textContent=''; }
		document.getElementById('submit').addEventListener('click', async () => {
			hideError(); result.classList.add('hidden');
			const fd = new FormData();
			if (pdf.files[0]) fd.append('pdf', pdf.files[0]);
			fd.append('pages', pages.value.trim());
			fd.append('quality', quality.value);
			try {
				const res = await fetch('/api/pdf-to-images', { method:'POST', body: fd });
				const data = await res.json();
				if(!res.ok || !data.success) throw new Error(data.error||'فشل التحويل');
				zip.href = data.zip_url; result.classList.remove('hidden');
			} catch(e){ showError(e.message); }
		});
	</script>
</body>
</html>
