<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>استخراج الصوت من الفيديو</title>
	<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-[#1b4965] via-[#62b6cb] to-[#e9c46a] text-white">
	<div class="max-w-4xl mx-auto p-6">
		<div class="flex items-center justify-between">
			<h1 class="text-3xl font-extrabold">تحويل الفيديو إلى ملف صوتي</h1>
			<a href="/tools" class="rounded-lg bg-white/90 text-[#1b4965] px-4 py-2 font-semibold">العودة للأدوات</a>
		</div>

		<div class="mt-6 bg-white/10 border border-white/20 rounded-2xl p-6">
			<form id="form" class="space-y-4" onsubmit="return false;">
				<div>
					<label class="block mb-1">رفع ملف فيديو (MP4, MKV, AVI وغيرها)</label>
					<input id="video" type="file" accept="video/*" class="block w-full text-black rounded" />
				</div>
				<div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
					<div>
						<label class="block mb-1">الصيغة</label>
						<select id="format" class="w-full rounded px-3 py-2 text-black">
							<option value="mp3">MP3</option>
							<option value="wav">WAV</option>
							<option value="ogg">OGG</option>
						</select>
					</div>
					<div>
						<label class="block mb-1">الجودة (bitrate)</label>
						<input id="bitrate" type="text" class="w-full rounded px-3 py-2 text-black" value="192k" />
					</div>
					<div>
						<label class="block mb-1">المدى (ثواني): البداية</label>
						<input id="start" type="number" class="w-full rounded px-3 py-2 text-black" placeholder="0" />
					</div>
				</div>
				<div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
					<div></div><div></div>
					<div>
						<label class="block mb-1">المدى (ثواني): النهاية</label>
						<input id="end" type="number" class="w-full rounded px-3 py-2 text-black" placeholder="مثال: 60" />
					</div>
				</div>
				<button id="submit" class="rounded-xl bg-[#e9c46a] text-[#7a3b2e] font-bold px-6 py-3">استخراج الصوت</button>
			</form>

			<div id="result" class="mt-4 hidden">
				<a id="download" class="rounded-xl bg-white text-[#1b4965] font-semibold px-4 py-2" href="#">تنزيل الملف الصوتي</a>
			</div>
			<div id="alert" class="mt-4 hidden rounded bg-red-500/20 border border-red-400/40 p-3"></div>
		</div>
	</div>

	<script>
		const video = document.getElementById('video');
		const format = document.getElementById('format');
		const bitrate = document.getElementById('bitrate');
		const start = document.getElementById('start');
		const end = document.getElementById('end');
		const result = document.getElementById('result');
		const download = document.getElementById('download');
		const alertBox = document.getElementById('alert');
		function showError(m){ alertBox.textContent=m; alertBox.classList.remove('hidden'); }
		function hideError(){ alertBox.classList.add('hidden'); alertBox.textContent=''; }
		document.getElementById('submit').addEventListener('click', async () => {
			hideError(); result.classList.add('hidden');
			const fd = new FormData();
			if (video.files[0]) fd.append('video', video.files[0]);
			fd.append('format', format.value);
			fd.append('bitrate', bitrate.value.trim());
			fd.append('start', start.value.trim());
			fd.append('end', end.value.trim());
			try {
				const res = await fetch('/api/video-to-audio', { method:'POST', body: fd });
				const data = await res.json();
				if(!res.ok || !data.success) throw new Error(data.error||'فشل التحويل');
				download.href = data.url; result.classList.remove('hidden');
			} catch(e){ showError(e.message); }
		});
	</script>
</body>
</html>
